---
title: 2.18 Cache, Rutas Y Despliegue Con Nginx Y Puma
published: 2025-10-25
tags: [ProgramacionWeb, RubyonRails, Rails, ITO, HTML, CSS]
category: ProgramacionWeb
draft: false
---

En esta lecci√≥n continuamos trabajando con el ejemplo **‚ÄúWelcome to the Head First Lounge‚Äù (p.69)**, analizando c√≥mo las **rutas**, la **cache del navegador** y la **configuraci√≥n del servidor** influyen en el desarrollo web.

---

## 1. Rutas relativas y absolutas

En el ejemplo ‚ÄúDemo2‚Äù, la ruta es **relativa**, ya que apunta dentro del mismo host. Esto se puede verificar al inspeccionar el c√≥digo:

* Si apunta al **mismo dominio**, es **relativa**.
* Si apunta a **otro servidor**, es **absoluta**.

Las rutas relativas son preferibles para **mantenimiento y portabilidad**, mientras que las absolutas se usan para **referencias externas**.

```bash
cd /var/www/html
cat style.css
```

Si cambiamos el nombre del archivo y el navegador a√∫n lo muestra, significa que est√° sirviendo desde **cache**. Esto puede ocultar errores (por ejemplo, archivos 404).

Con **Firefox Developer Tools ‚Üí More Tools ‚Üí Style Editor**, podemos ver el contenido real, incluso si el archivo fue borrado o renombrado.
Los c√≥digos m√°s comunes son:

* **200:** Recurso encontrado.
* **404:** Archivo no encontrado.

> üí° **Consejo:** en desarrollo, usa `no-cache` para forzar la recarga real del archivo y evitar confusiones.

---

## 2. Organizaci√≥n del proyecto

Para mantener orden y claridad, se recomienda crear directorios separados:

* `/images/` ‚Üí para im√°genes
* `/css/` ‚Üí para estilos
* `/js/` ‚Üí para scripts

Esto evita rutas confusas y facilita el mantenimiento, incluso si se usan rutas absolutas.

**Objetivo:** que la aplicaci√≥n funcione correctamente en **todos los navegadores est√°ndares** (como Mozilla), garantizando al menos un **95% de compatibilidad.**

---

## 3. Uso de logs y an√°lisis de tr√°fico

Los archivos de error y acceso de **Nginx** permiten entender c√≥mo los usuarios interact√∫an con el sistema:

```bash
cd /var/log/nginx
sudo cat error.log
sudo apt install goaccess
```

Con **GoAccess**, podemos ver estad√≠sticas en tiempo real:

* Errores **404**, **500**, tr√°fico y **carga por minuto**.
* Permite estimar la demanda (por ejemplo, 1000 hits / 5 minutos).
* Muestra navegadores, IPs y patrones de acceso.

---

## 4. Despliegue con Nginx, Puma y Passenger

Para entornos de producci√≥n, se recomienda usar **Nginx** como **proxy inverso** y **Puma** como servidor de aplicaciones Ruby on Rails:

```bash
# Ejemplo de configuraci√≥n
passenger_enabled on;
```

Sin embargo, **Passenger** requiere compilaci√≥n con cada actualizaci√≥n.
Por eso, la mejor pr√°ctica actual es usar **Puma** con Nginx como balanceador:

* Nginx atiende las peticiones HTTP.
* Puma ejecuta la aplicaci√≥n Ruby on Rails.
* Ambos trabajan de forma **segura** y **aislada**.

Ventajas:

* Aislamiento entre entornos (cada aplicaci√≥n usa sus gemas).
* Mayor seguridad (sin permisos privilegiados).
* Menos dependencias y mejor mantenimiento.

---

## 5. Puertos y seguridad

En otros servidores (como Java), las aplicaciones suelen correr en el puerto **8080**, mientras que Nginx escucha en el **80** y redirige al puerto interno.

> ‚ö†Ô∏è **Nota:** los puertos inferiores a **1024** pueden ser explotados; por seguridad, es recomendable usar puertos superiores en producci√≥n.

---

## 6. Cache y entorno de desarrollo

Ruby on Rails, por defecto, **no usa cache en desarrollo**, precisamente para evitar errores causados por archivos almacenados en el navegador.
Esto permite ver cambios al instante y detectar problemas en rutas, hojas de estilo o vistas.

---

## Glosario

| T√©rmino           | Definici√≥n                                                                         |
| :---------------- | :--------------------------------------------------------------------------------- |
| **Ruta relativa** | Apunta a un archivo dentro del mismo servidor o carpeta.                           |
| **Ruta absoluta** | Incluye el dominio o protocolo completo (ej. `https://example.com/img.png`).       |
| **Cache**         | Memoria temporal del navegador que guarda recursos para acelerar carga.            |
| **Nginx**         | Servidor web y proxy inverso ligero y r√°pido.                                      |
| **Puma**          | Servidor de aplicaciones para Ruby on Rails.                                       |
| **Proxy inverso** | Servidor que recibe las peticiones y las reenv√≠a a otro servidor interno.          |
| **GoAccess**      | Herramienta para analizar logs de Nginx en tiempo real.                            |
| **Passenger**     | M√≥dulo que permite ejecutar Rails directamente desde Nginx (requiere compilaci√≥n). |

---

###  Reflexi√≥n final

Las rutas, el cache y la configuraci√≥n del servidor son la base invisible de toda aplicaci√≥n web. Entender c√≥mo viaja una petici√≥n, d√≥nde se guarda la informaci√≥n y c√≥mo se despliega un proyecto garantiza no solo un mejor rendimiento, sino tambi√©n **seguridad, mantenimiento y compatibilidad real con los usuarios.**
